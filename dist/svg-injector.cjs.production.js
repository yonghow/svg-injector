"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var cloneSvg=function(e){return e.cloneNode(!0)},isLocal=function(){return"file:"===window.location.protocol},svgCache=new Map,requestQueue={},queueRequest=function(e,t){requestQueue[e]=requestQueue[e]||[],requestQueue[e].push(t)},processRequestQueue=function(e){for(var t=function(t,r){setTimeout((function(){if(Array.isArray(requestQueue[e])){var r=svgCache.get(e),n=requestQueue[e][t];(r instanceof SVGSVGElement||r instanceof HTMLElement)&&n(null,cloneSvg(r)),r instanceof Error&&n(r),t===requestQueue[e].length-1&&delete requestQueue[e]}}),0)},r=0,n=requestQueue[e].length;r<n;r++)t(r)},loadSvg=function(e,t,r){if(svgCache.has(e)){var n=svgCache.get(e);return n instanceof SVGSVGElement||n instanceof HTMLElement?void r(null,cloneSvg(n)):n instanceof Error?void r(n):void queueRequest(e,r)}svgCache.set(e,void 0),queueRequest(e,r);var i=new XMLHttpRequest;i.withCredentials=t,i.onreadystatechange=function(){try{if(4===i.readyState){if(404===i.status||null===i.responseXML)throw new Error(isLocal()?"Note: SVG injection ajax calls do not work locally without adjusting security setting in your browser. Or consider using a local webserver.":"Unable to load SVG file: "+e);if(!(200===i.status||isLocal()&&0===i.status))throw new Error("There was a problem injecting the SVG: "+i.status+" "+i.statusText);i.responseXML instanceof Document&&i.responseXML.documentElement&&svgCache.set(e,i.responseXML.documentElement),processRequestQueue(e)}}catch(t){svgCache.set(e,t),processRequestQueue(e)}},i.open("GET",e),i.overrideMimeType&&i.overrideMimeType("text/xml"),i.send()},idCounter=0,uniqueId=function(){return++idCounter},__spreadArrays=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var s=arguments[t],a=0,o=s.length;a<o;a++,i++)n[i]=s[a];return n},injectedElements=[],ranScripts={},svgNamespace="http://www.w3.org/2000/svg",xlinkNamespace="http://www.w3.org/1999/xlink",injectElement=function(e,t,r,n,i,s){var a=e.getAttribute("data-src")||e.getAttribute("src");if(a&&/\.svg/i.test(a)){if(-1!==injectedElements.indexOf(e))return injectedElements.splice(injectedElements.indexOf(e),1),void(e=null);injectedElements.push(e),e.setAttribute("src",""),loadSvg(a,i,(function(i,o){if(!o)return injectedElements.splice(injectedElements.indexOf(e),1),e=null,void s(i);var l=e.getAttribute("id");l&&o.setAttribute("id",l);var u=e.getAttribute("title");u&&o.setAttribute("title",u);var c=e.getAttribute("width");c&&o.setAttribute("width",c);var f=e.getAttribute("height");f&&o.setAttribute("height",f);var v=Array.from(new Set(__spreadArrays((o.getAttribute("class")||"").split(" "),["injected-svg"],(e.getAttribute("class")||"").split(" ")))).join(" ").trim();o.setAttribute("class",v);var d=e.getAttribute("style");d&&o.setAttribute("style",d),o.setAttribute("data-src",a);var p=[].filter.call(e.attributes,(function(e){return/^data-\w[\w-]*$/.test(e.name)}));if(Array.prototype.forEach.call(p,(function(e){e.name&&e.value&&o.setAttribute(e.name,e.value)})),r){var h,g,m,A,w={clipPath:["clip-path"],"color-profile":["color-profile"],cursor:["cursor"],filter:["filter"],linearGradient:["fill","stroke"],marker:["marker","marker-start","marker-mid","marker-end"],mask:["mask"],path:[],pattern:["fill","stroke"],radialGradient:["fill","stroke"]};Object.keys(w).forEach((function(e){g=w[e];for(var t=function(e,t){var r;A=(m=h[e].id)+"-"+uniqueId(),Array.prototype.forEach.call(g,(function(e){for(var t=0,n=(r=o.querySelectorAll("["+e+'*="'+m+'"]')).length;t<n;t++){var i=r[t].getAttribute(e);i&&!i.match(new RegExp("url\\(#"+m+"\\)"))||r[t].setAttribute(e,"url(#"+A+")")}}));for(var n=o.querySelectorAll("[*|href]"),i=[],s=0,a=n.length;s<a;s++){var l=n[s].getAttributeNS(xlinkNamespace,"href");l&&l.toString()==="#"+h[e].id&&i.push(n[s])}for(var u=0,c=i.length;u<c;u++)i[u].setAttributeNS(xlinkNamespace,"href","#"+A);h[e].id=A},r=0,n=(h=o.querySelectorAll(e+"[id]")).length;r<n;r++)t(r)}))}o.removeAttribute("xmlns:a");for(var E,b,y=o.querySelectorAll("script"),S=[],x=0,j=y.length;x<j;x++)(b=y[x].getAttribute("type"))&&"application/ecmascript"!==b&&"application/javascript"!==b&&"text/javascript"!==b||((E=y[x].innerText||y[x].textContent)&&S.push(E),o.removeChild(y[x]));if(S.length>0&&("always"===t||"once"===t&&!ranScripts[a])){for(var q=0,k=S.length;q<k;q++)new Function(S[q])(window);ranScripts[a]=!0}var C=o.querySelectorAll("style");Array.prototype.forEach.call(C,(function(e){e.textContent+=""})),o.setAttribute("xmlns",svgNamespace),o.setAttribute("xmlns:xlink",xlinkNamespace),n(o),e.parentNode&&e.parentNode.replaceChild(o,e),injectedElements.splice(injectedElements.indexOf(e),1),e=null,s(null,o)}))}else s(new Error("Attempted to inject a file with a non-svg extension: "+a))};!function(e){e.Always="always",e.Once="once",e.Never="never"}(exports.EvalScripts||(exports.EvalScripts={}));var SVGInjector=function(e,t){var r=void 0===t?{}:t,n=r.afterAll,i=void 0===n?function(){}:n,s=r.afterEach,a=void 0===s?function(){}:s,o=r.beforeEach,l=void 0===o?function(){}:o,u=r.evalScripts,c=void 0===u?exports.EvalScripts.Never:u,f=r.renumerateIRIElements,v=void 0===f||f,d=r.withCredentials,p=void 0!==d&&d;if(e&&"length"in e)for(var h=0,g=0,m=e.length;g<m;g++)injectElement(e[g],c,v,l,p,(function(t,r){a(t,r),e&&"length"in e&&e.length===++h&&i(h)}));else e?injectElement(e,c,v,l,p,(function(t,r){a(t,r),i(1),e=null})):i(0)};exports.SVGInjector=SVGInjector;
//# sourceMappingURL=svg-injector.cjs.production.js.map
